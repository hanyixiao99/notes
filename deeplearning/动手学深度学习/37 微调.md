# 37 微调

<!--微调通过使用在大数据上得到的预训练好的模型来初始化模型权重来完成提升精度-->

<!--预训练模型质量很重要-->

<!--微调通常速度更快、精度更高-->

标注一个数据集很贵

想在已经对物体识别有基础的情况下，不需要很多数据集也能做好以后的新数据识别

## 网络架构

一般来说一个神经网络可以分成两块

- 特征抽取将原始像素变成容易线性分割的特征
- 线性分类器来做分类（softmax回归）

## 微调

假设在源数据集上已经训练好模型，特征提取层即然能对ImageNet进行比较好的特征提取，那么对自己的数据集也可以达到很好的效果

- 将模型的特征提取块再次使用

<img src="/Users/hanyixiao/Library/Application Support/typora-user-images/截屏2021-12-14 16.44.28.png" alt="截屏2021-12-14 16.44.28" style="zoom:50%;" />

## 微调中的权重初始化

<img src="/Users/hanyixiao/Library/Application Support/typora-user-images/截屏2021-12-14 16.45.47.png" alt="截屏2021-12-14 16.45.47" style="zoom:50%;" />

## 训练

是一个目标数据集上的正常训练任务，但是使用更强的正则化

- 使用更小的学习率
- 使用更少的数据迭代

源数据集远复杂于目标数据，通常微调效果更好

### 使用分类器权重

源数据集可能也有目标数据中的部分标号

可以使用预训练好的模型分类器中对应标号对应的向量来做初始化

### 固定一些层

神将网络通常学习有层次的特征表示

- 低层次的特征更加通用
- 高层次的特征则更跟数据集相关

可以固定底部一些层的参数，不参与更新

- 更强的正则